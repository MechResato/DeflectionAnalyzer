   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,6
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "measure.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .comm _msCounter,4,4
  20              	 .comm tft_tick,1,1
  21              	 .comm MeasurementCounter,4,4
  22              	 .comm InputBuffer1_idx,2,2
  23              	 .comm InputType,1,1
  24              	 .comm frameover,1,1
  25              	 .global lastval
  26              	 .section .bss.lastval,"aw",%nobits
  27              	 .align 2
  30              	lastval:
  31 0000 00000000 	 .space 4
  32              	 .global __aeabi_ui2d
  33              	 .global __aeabi_ddiv
  34              	 .global __aeabi_dmul
  35              	 .global __aeabi_dadd
  36              	 .global __aeabi_d2uiz
  37              	 .section .text.VADC0_C0_2_IRQHandler,"ax",%progbits
  38              	 .align 2
  39              	 .global VADC0_C0_2_IRQHandler
  40              	 .thumb
  41              	 .thumb_func
  43              	VADC0_C0_2_IRQHandler:
  44              	.LFB485:
  45              	 .file 1 "../measure.c"
   1:../measure.c  **** /*
   2:../measure.c  ****  * measure.c
   3:../measure.c  ****  *
   4:../measure.c  ****  *  Created on: 20 Feb 2021
   5:../measure.c  ****  *      Author: RS
   6:../measure.c  ****  */
   7:../measure.c  **** 
   8:../measure.c  **** #include <DAVE.h>
   9:../measure.c  **** #include <stdio.h>
  10:../measure.c  **** #include <stdint.h>
  11:../measure.c  **** #include <math.h>
  12:../measure.c  **** #include <globals.h>
  13:../measure.c  **** 
  14:../measure.c  **** uint32_t lastval = 0; // just for TestTriangle signal
  15:../measure.c  **** 
  16:../measure.c  **** void Adc_Measurement_Handler(void){
  46              	 .loc 1 16 0
  47              	 .cfi_startproc
  48              	 
  49              	 
  50 0000 98B5     	 push {r3,r4,r7,lr}
  51              	.LCFI0:
  52              	 .cfi_def_cfa_offset 16
  53              	 .cfi_offset 3,-16
  54              	 .cfi_offset 4,-12
  55              	 .cfi_offset 7,-8
  56              	 .cfi_offset 14,-4
  57 0002 00AF     	 add r7,sp,#0
  58              	.LCFI1:
  59              	 .cfi_def_cfa_register 7
  17:../measure.c  **** 	/// Do measurements and store result in buffer. Allows to 'measure' self produced test signal base
  18:../measure.c  **** 	/// uses global/extern variables: InputType, InputBuffer1_idx, InputBuffer1_size, InputBuffer1, tf
  19:../measure.c  **** 
  20:../measure.c  **** 	// Increment current Buffer index and set back to 0 if greater than size of array
  21:../measure.c  **** 	InputBuffer1_idx++;
  60              	 .loc 1 21 0
  61 0004 664B     	 ldr r3,.L13+24
  62 0006 1B88     	 ldrh r3,[r3]
  63 0008 0133     	 adds r3,r3,#1
  64 000a 9AB2     	 uxth r2,r3
  65 000c 644B     	 ldr r3,.L13+24
  66 000e 1A80     	 strh r2,[r3]
  22:../measure.c  **** 	if(InputBuffer1_idx >= INPUTBUFFER1_SIZE){
  67              	 .loc 1 22 0
  68 0010 634B     	 ldr r3,.L13+24
  69 0012 1B88     	 ldrh r3,[r3]
  70 0014 B3F5DC7F 	 cmp r3,#440
  71 0018 05D3     	 bcc .L2
  23:../measure.c  **** 		//printf("fo\n");
  24:../measure.c  **** 		frameover = 1;
  72              	 .loc 1 24 0
  73 001a 624B     	 ldr r3,.L13+28
  74 001c 0122     	 movs r2,#1
  75 001e 1A70     	 strb r2,[r3]
  25:../measure.c  **** 		InputBuffer1_idx = 0;
  76              	 .loc 1 25 0
  77 0020 5F4B     	 ldr r3,.L13+24
  78 0022 0022     	 movs r2,#0
  79 0024 1A80     	 strh r2,[r3]
  80              	.L2:
  26:../measure.c  **** 	}
  27:../measure.c  **** 
  28:../measure.c  **** 	/// Read next value from sensor
  29:../measure.c  **** 	 switch (InputType){
  81              	 .loc 1 29 0
  82 0026 604B     	 ldr r3,.L13+32
  83 0028 1B78     	 ldrb r3,[r3]
  84 002a DBB2     	 uxtb r3,r3
  85 002c 032B     	 cmp r3,#3
  86 002e 00F29F80 	 bhi .L3
  87 0032 01A2     	 adr r2,.L5
  88 0034 52F823F0 	 ldr pc,[r2,r3,lsl#2]
  89              	 .p2align 2
  90              	.L5:
  91 0038 49000000 	 .word .L4+1
  92 003c 61000000 	 .word .L6+1
  93 0040 9D000000 	 .word .L7+1
  94 0044 E3000000 	 .word .L8+1
  95              	 .p2align 1
  96              	.L4:
  30:../measure.c  **** 		// 0 ADC Sensor 5
  31:../measure.c  **** 		case 0:
  32:../measure.c  **** 			InputBuffer1[InputBuffer1_idx] = ADC_MEASUREMENT_GetResult(&ADC_MEASUREMENT_Channel_A); //result
  97              	 .loc 1 32 0
  98 0048 554B     	 ldr r3,.L13+24
  99 004a 1B88     	 ldrh r3,[r3]
 100 004c 1C46     	 mov r4,r3
 101 004e 5748     	 ldr r0,.L13+36
 102 0050 FFF7FEFF 	 bl ADC_MEASUREMENT_GetResult
 103 0054 0346     	 mov r3,r0
 104 0056 1A46     	 mov r2,r3
 105 0058 554B     	 ldr r3,.L13+40
 106 005a 23F81420 	 strh r2,[r3,r4,lsl#1]
  33:../measure.c  **** 			break;
 107              	 .loc 1 33 0
 108 005e 87E0     	 b .L3
 109              	.L6:
  34:../measure.c  **** 		// 1 TestImpulse
  35:../measure.c  **** 		case 1:
  36:../measure.c  **** 			if(InputBuffer1_idx % (INPUTBUFFER1_SIZE/5)) InputBuffer1[InputBuffer1_idx] = 0;
 110              	 .loc 1 36 0
 111 0060 4F4B     	 ldr r3,.L13+24
 112 0062 1B88     	 ldrh r3,[r3]
 113 0064 534A     	 ldr r2,.L13+44
 114 0066 A2FB0312 	 umull r1,r2,r2,r3
 115 006a 9209     	 lsrs r2,r2,#6
 116 006c 5821     	 movs r1,#88
 117 006e 01FB02F2 	 mul r2,r1,r2
 118 0072 9B1A     	 subs r3,r3,r2
 119 0074 9BB2     	 uxth r3,r3
 120 0076 002B     	 cmp r3,#0
 121 0078 07D0     	 beq .L9
 122              	 .loc 1 36 0 is_stmt 0 discriminator 1
 123 007a 494B     	 ldr r3,.L13+24
 124 007c 1B88     	 ldrh r3,[r3]
 125 007e 1A46     	 mov r2,r3
 126 0080 4B4B     	 ldr r3,.L13+40
 127 0082 0021     	 movs r1,#0
 128 0084 23F81210 	 strh r1,[r3,r2,lsl#1]
  37:../measure.c  **** 			else InputBuffer1[InputBuffer1_idx] = 4095;
  38:../measure.c  **** 			break;
 129              	 .loc 1 38 0 is_stmt 1 discriminator 1
 130 0088 72E0     	 b .L3
 131              	.L9:
  37:../measure.c  **** 			else InputBuffer1[InputBuffer1_idx] = 4095;
 132              	 .loc 1 37 0
 133 008a 454B     	 ldr r3,.L13+24
 134 008c 1B88     	 ldrh r3,[r3]
 135 008e 1A46     	 mov r2,r3
 136 0090 474B     	 ldr r3,.L13+40
 137 0092 40F6FF71 	 movw r1,#4095
 138 0096 23F81210 	 strh r1,[r3,r2,lsl#1]
 139              	 .loc 1 38 0
 140 009a 69E0     	 b .L3
 141              	.L7:
  39:../measure.c  **** 		// 2 TestSawtooth
  40:../measure.c  **** 		case 2:
  41:../measure.c  **** 			if(lastval < 4095) InputBuffer1[InputBuffer1_idx] = lastval+14;
 142              	 .loc 1 41 0
 143 009c 464B     	 ldr r3,.L13+48
 144 009e 1B68     	 ldr r3,[r3]
 145 00a0 40F6FE72 	 movw r2,#4094
 146 00a4 9342     	 cmp r3,r2
 147 00a6 0BD8     	 bhi .L11
 148              	 .loc 1 41 0 is_stmt 0 discriminator 1
 149 00a8 3D4B     	 ldr r3,.L13+24
 150 00aa 1B88     	 ldrh r3,[r3]
 151 00ac 1A46     	 mov r2,r3
 152 00ae 424B     	 ldr r3,.L13+48
 153 00b0 1B68     	 ldr r3,[r3]
 154 00b2 9BB2     	 uxth r3,r3
 155 00b4 0E33     	 adds r3,r3,#14
 156 00b6 99B2     	 uxth r1,r3
 157 00b8 3D4B     	 ldr r3,.L13+40
 158 00ba 23F81210 	 strh r1,[r3,r2,lsl#1]
 159 00be 06E0     	 b .L12
 160              	.L11:
  42:../measure.c  **** 			else InputBuffer1[InputBuffer1_idx] = 0;
 161              	 .loc 1 42 0 is_stmt 1
 162 00c0 374B     	 ldr r3,.L13+24
 163 00c2 1B88     	 ldrh r3,[r3]
 164 00c4 1A46     	 mov r2,r3
 165 00c6 3A4B     	 ldr r3,.L13+40
 166 00c8 0021     	 movs r1,#0
 167 00ca 23F81210 	 strh r1,[r3,r2,lsl#1]
 168              	.L12:
  43:../measure.c  **** 			lastval = InputBuffer1[InputBuffer1_idx];
 169              	 .loc 1 43 0
 170 00ce 344B     	 ldr r3,.L13+24
 171 00d0 1B88     	 ldrh r3,[r3]
 172 00d2 1A46     	 mov r2,r3
 173 00d4 364B     	 ldr r3,.L13+40
 174 00d6 33F81230 	 ldrh r3,[r3,r2,lsl#1]
 175 00da 1A46     	 mov r2,r3
 176 00dc 364B     	 ldr r3,.L13+48
 177 00de 1A60     	 str r2,[r3]
  44:../measure.c  **** 			break;
 178              	 .loc 1 44 0
 179 00e0 46E0     	 b .L3
 180              	.L8:
  45:../measure.c  **** 		// 3 TestSine (Note: The used time variable is not perfect for this purpose)
  46:../measure.c  **** 		case 3:
  47:../measure.c  **** 			InputBuffer1[InputBuffer1_idx] = (uint32_t)((0.5*(1.0+sin(2.0 * M_PI * 11.725 * ((double)Measure
 181              	 .loc 1 47 0
 182 00e2 2F4B     	 ldr r3,.L13+24
 183 00e4 1B88     	 ldrh r3,[r3]
 184 00e6 1C46     	 mov r4,r3
 185 00e8 344B     	 ldr r3,.L13+52
 186 00ea 1B68     	 ldr r3,[r3]
 187 00ec 1846     	 mov r0,r3
 188 00ee FFF7FEFF 	 bl __aeabi_ui2d
 189 00f2 0246     	 mov r2,r0
 190 00f4 0B46     	 mov r3,r1
 191 00f6 1046     	 mov r0,r2
 192 00f8 1946     	 mov r1,r3
 193 00fa 23A3     	 adr r3,.L13
 194 00fc D3E90023 	 ldrd r2,[r3]
 195 0100 FFF7FEFF 	 bl __aeabi_ddiv
 196 0104 0246     	 mov r2,r0
 197 0106 0B46     	 mov r3,r1
 198 0108 1046     	 mov r0,r2
 199 010a 1946     	 mov r1,r3
 200 010c 20A3     	 adr r3,.L13+8
 201 010e D3E90023 	 ldrd r2,[r3]
 202 0112 FFF7FEFF 	 bl __aeabi_dmul
 203 0116 0246     	 mov r2,r0
 204 0118 0B46     	 mov r3,r1
 205 011a 1046     	 mov r0,r2
 206 011c 1946     	 mov r1,r3
 207 011e FFF7FEFF 	 bl sin
 208 0122 0246     	 mov r2,r0
 209 0124 0B46     	 mov r3,r1
 210 0126 1046     	 mov r0,r2
 211 0128 1946     	 mov r1,r3
 212 012a 4FF00002 	 mov r2,#0
 213 012e 244B     	 ldr r3,.L13+56
 214 0130 FFF7FEFF 	 bl __aeabi_dadd
 215 0134 0246     	 mov r2,r0
 216 0136 0B46     	 mov r3,r1
 217 0138 1046     	 mov r0,r2
 218 013a 1946     	 mov r1,r3
 219 013c 4FF00002 	 mov r2,#0
 220 0140 204B     	 ldr r3,.L13+60
 221 0142 FFF7FEFF 	 bl __aeabi_dmul
 222 0146 0246     	 mov r2,r0
 223 0148 0B46     	 mov r3,r1
 224 014a 1046     	 mov r0,r2
 225 014c 1946     	 mov r1,r3
 226 014e 12A3     	 adr r3,.L13+16
 227 0150 D3E90023 	 ldrd r2,[r3]
 228 0154 FFF7FEFF 	 bl __aeabi_dmul
 229 0158 0246     	 mov r2,r0
 230 015a 0B46     	 mov r3,r1
 231 015c 1046     	 mov r0,r2
 232 015e 1946     	 mov r1,r3
 233 0160 FFF7FEFF 	 bl __aeabi_d2uiz
 234 0164 0346     	 mov r3,r0
 235 0166 9AB2     	 uxth r2,r3
 236 0168 114B     	 ldr r3,.L13+40
 237 016a 23F81420 	 strh r2,[r3,r4,lsl#1]
  48:../measure.c  **** 			break;
 238              	 .loc 1 48 0
 239 016e 00BF     	 nop
 240              	.L3:
  49:../measure.c  **** 	 }
  50:../measure.c  **** 
  51:../measure.c  **** 	// Trigger next main loop (with his it is running in synch with the measurement -> change if neede
  52:../measure.c  **** 	tft_tick = 42;
 241              	 .loc 1 52 0
 242 0170 154B     	 ldr r3,.L13+64
 243 0172 2A22     	 movs r2,#42
 244 0174 1A70     	 strb r2,[r3]
  53:../measure.c  **** 
  54:../measure.c  **** 	// Increase count of executed measurements
  55:../measure.c  **** 	MeasurementCounter++;
 245              	 .loc 1 55 0
 246 0176 114B     	 ldr r3,.L13+52
 247 0178 1B68     	 ldr r3,[r3]
 248 017a 0133     	 adds r3,r3,#1
 249 017c 0F4A     	 ldr r2,.L13+52
 250 017e 1360     	 str r3,[r2]
  56:../measure.c  **** }
 251              	 .loc 1 56 0
 252 0180 98BD     	 pop {r3,r4,r7,pc}
 253              	.L14:
 254 0182 00BFAFF3 	 .align 3
 254      0080
 255              	.L13:
 256 0188 00000000 	 .word 0
 257 018c 0070A740 	 .word 1084715008
 258 0190 A5C226FA 	 .word -98123099
 259 0194 E66A5240 	 .word 1079143142
 260 0198 00000000 	 .word 0
 261 019c 00FEAF40 	 .word 1085275648
 262 01a0 00000000 	 .word InputBuffer1_idx
 263 01a4 00000000 	 .word frameover
 264 01a8 00000000 	 .word InputType
 265 01ac 00000000 	 .word ADC_MEASUREMENT_Channel_A_handle
 266 01b0 00000000 	 .word InputBuffer1
 267 01b4 A38B2EBA 	 .word -1171354717
 268 01b8 00000000 	 .word lastval
 269 01bc 00000000 	 .word MeasurementCounter
 270 01c0 0000F03F 	 .word 1072693248
 271 01c4 0000E03F 	 .word 1071644672
 272 01c8 00000000 	 .word tft_tick
 273              	 .cfi_endproc
 274              	.LFE485:
 276 01cc AFF30080 	 .text
 277              	.Letext0:
 278              	 .file 2 "c:\\workspaces\\dave_4-4-2_64bit_2018-02-23\\dave-ide-4.4.2-64bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 279              	 .file 3 "c:\\workspaces\\dave_4-4-2_64bit_2018-02-23\\dave-ide-4.4.2-64bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
 280              	 .file 4 "C:/Workspaces/DAVE-4.4.2-64Bit_WS/DeflectionAnalyzer/Libraries/CMSIS/Infineon/XMC4700_series/Include/XMC4700.h"
 281              	 .file 5 "C:/Workspaces/DAVE-4.4.2-64Bit_WS/DeflectionAnalyzer/Libraries/XMCLib/inc/xmc_usic.h"
 282              	 .file 6 "C:/Workspaces/DAVE-4.4.2-64Bit_WS/DeflectionAnalyzer/Libraries/XMCLib/inc/xmc_vadc.h"
 283              	 .file 7 "C:/Workspaces/DAVE-4.4.2-64Bit_WS/DeflectionAnalyzer/Dave/Generated/ADC_MEASUREMENT/adc_measurement.h"
 284              	 .file 8 "C:/Workspaces/DAVE-4.4.2-64Bit_WS/DeflectionAnalyzer/globals.h"
 285              	 .file 9 "C:/Workspaces/DAVE-4.4.2-64Bit_WS/DeflectionAnalyzer/Libraries/CMSIS/Include/cmsis_gcc.h"
 286              	 .file 10 "C:/Workspaces/DAVE-4.4.2-64Bit_WS/DeflectionAnalyzer/Libraries/CMSIS/Include/core_cm4.h"
 287              	 .file 11 "C:/Workspaces/DAVE-4.4.2-64Bit_WS/DeflectionAnalyzer/Libraries/CMSIS/Infineon/XMC4700_series/Include/system_XMC4700.h"
 288              	 .file 12 "C:/Workspaces/DAVE-4.4.2-64Bit_WS/DeflectionAnalyzer/Dave/Generated/ADC_MEASUREMENT/ADC_MEASUREMENT_Extern.h"
DEFINED SYMBOLS
                            *ABS*:00000000 measure.c
                            *COM*:00000004 _msCounter
                            *COM*:00000001 tft_tick
                            *COM*:00000004 MeasurementCounter
                            *COM*:00000002 InputBuffer1_idx
                            *COM*:00000001 InputType
                            *COM*:00000001 frameover
    {standard input}:30     .bss.lastval:00000000 lastval
    {standard input}:27     .bss.lastval:00000000 $d
    {standard input}:38     .text.VADC0_C0_2_IRQHandler:00000000 $t
    {standard input}:43     .text.VADC0_C0_2_IRQHandler:00000000 VADC0_C0_2_IRQHandler
    {standard input}:91     .text.VADC0_C0_2_IRQHandler:00000038 $d
    {standard input}:95     .text.VADC0_C0_2_IRQHandler:00000048 $t
    {standard input}:256    .text.VADC0_C0_2_IRQHandler:00000188 $d
                     .debug_frame:00000010 $d
    {standard input}:276    .text.VADC0_C0_2_IRQHandler:000001cc $t

UNDEFINED SYMBOLS
__aeabi_ui2d
__aeabi_ddiv
__aeabi_dmul
__aeabi_dadd
__aeabi_d2uiz
ADC_MEASUREMENT_GetResult
sin
ADC_MEASUREMENT_Channel_A_handle
InputBuffer1
